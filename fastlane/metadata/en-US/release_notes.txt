Code converted to Swift 3;
Performance improvements;
Bug fixes.
